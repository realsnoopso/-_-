# 스코프

- 모든 식별자(변수 이름, 함수 이름, 클래스 이름 등)는 자신이 선언된 위치에 의해 다른 코드가 자신을 참조할 수 있는 유효범위가 결정됨
- 즉, 스코프는 식별자가 유효한 범위를 말한다.

```javascript
function add(x, y) {
  // 매개변수는 함수 몸체 내부에서만 참조할 수 있다.
  // 즉, 매개변수의 스코프(유효범위)는 함수 몸체 내부다.
  console.log(x, y); // 2 5
  return x + y;
}
add(2, 5);
// 매개변수는 함수 몸체 내부에서만 참조할 수 있다.
console.log(x, y); // ReferenceError: x is not defined
```

```javascript
var x = 'global';
function foo() {
  var x = 'local';
  console.log(x); // ①
}
foo();
console.log(x); // ②
```

- 코드의 가장 바깥 영역 foo 함수 내부에 같은 이름을 갖는 x 선언
- 이 때 자바스크립트 엔진은 이름이 같은 두 개의 변수 중 어떤 변수를 참조해야 할 것인지 결정
- 이를 식별자 결정이라고 함
- 만약 스코프라는 개념이 없다면 같은 이름을 갖는 변수는 충돌을 일으킴, 프로그램 전체에서 하나 밖에 사용할 수 없음
- 하나의 값은 유일한 식별자에 연결되어야 한다.

# 스코프의 종류

1. 전역과 전역 스코프

- 지역이란 함수 몸체 내부를 말한다.
- 지역 변수는 자신의 지역 스코프와 하위 지역 스코프에서 유효하다.
- 모든 스코프는 하나의 계층적 구조로 연결됨
- 모든 지역 스코프의 최상위 스코프는 전역 스코프
- 이렇게 스코프가 계층적으로 연결된 것을 스코프 체인이라고 함

2. 스코프 체인

- 상위 스코프에서 유효한 유효한 변수는 하위 스코프에서 자유롭게 참조 가능, 하지만 하위 스코프의 변수를 상위 스코프에서는 참조할 수 없음
- 즉, 상속 관계와 유사

```javascript
// 전역 함수
function foo() {
  console.log('global function foo');
}
function bar() {
  // 중첩 함수
  function foo() {
    console.log('local function foo');
  }
  foo(); // ①
}
bar();
```

- 함수도 식별자에 할당되기 때문에 스코프를 갖는다.

3. 함수 레벨 스코프

- 코드 블록이 아닌 함수에 의해서만 지역 스코프가 생성됨
- var 키워드로 선언된 변수는 오로지 함수의 코드 블록(함수 몸체) 만을 지역 스코프로 인정

4. 렉시컬 스코프

```javascript
var x = 1;
function foo() {
  var x = 10;
  bar();
}
function bar() {
  console.log(x);
}

foo(); // ?
bar(); // ?
```

- 동적 스코프: 함수를 어디서 호출했는지에 따라 함수의 상위 스코프를 결정
- 렉시컬 또는 정적 스코프: 함수를 어디서 정의했는지에 따라 함수의 상위 스코프를 결정

- 자바스크립트를 비롯한 대부분의 프로그래밍 언어는 렉시컬 스코프를 따름
- 함수의 상위 스코프는 언제나 자신이 정의된 스코프
- 함수의 상위 스코프는 함수 정의가 실행될 때 정적으로 결정
- 함수 정의가 실행되어 생성된 함수 객체는 이렇게 결정된 상위 스코프를 기억함
- 함수가 호출될 때마다 함수의 상위 스코프를 참조할 필요가 있기 때문
